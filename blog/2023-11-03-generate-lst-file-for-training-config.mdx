---
title: Quickly generate training file lists and validation file lists of a large dataset for deep learning codes
authors: [visualdust]
tags: [dataset]
---

In this page I will use the [cityscapes dataset](https://www.cityscapes-dataset.com/) and the [ADE20k](https://groups.csail.mit.edu/vision/datasets/ADE20K/) dataset (specifically ADEChallengeData2016) as examples to demonstrate a general approach to generate trainning file list and validation file list.

Sometimes you try to run deep learning codes that require training file lists and validation file lists in the configuration file. For example, HRNet requires a training file list in its [config file](https://github.com/HRNet/HRNet-Semantic-Segmentation/blob/HRNet-OCR/experiments/cityscapes/seg_hrnet_ocr_w48_train_512x1024_sgd_lr1e-2_wd5e-4_bs_12_epoch484.yaml), looks like:

```yaml
DATASET:
  DATASET: cityscapes
  ROOT: data/
  TEST_SET: 'list/cityscapes/val.lst'
  TRAIN_SET: 'list/cityscapes/train.lst'
  NUM_CLASSES: 19
```

Or sometimes you want to generate a list of training pictures and related annotations for training, building a dataset via `torch.utils.data.Dataset`. For example, I would simply implement a dataset by:

```python
from torch.utils import data

class Cityscapes(data.Dataset):
    def __init__(self,
                 root,
                 list_path,
                 num_classes=19):
                 
        self.num_classes = num_classes      
        self.list_path = list_path

        # some other init
    
    def __getitem__(self, index):
        
        image = cv2.imread(... # read from a path in self.list_path
        label = cv2.imread(... # read from a path in self.list_path
        
        # some post processing

        return image.copy(), label.copy()
```

It's a simple approach. 

**However, datasets may not provide those lists** and you have to generate `train.lst` and `val.lst` by your self. 

:::tip
The key to solving this problem is how to establish the corresponding relationship between training data and annotations.
:::

```python


```